# æ¨¡å¼è¯†åˆ«ä¸æœºå™¨å­¦ä¹ æŠ¥å‘Š
| å§“å   | å­¦å·       | ç­çº§     |
| ------ | ---------- | -------- |
| å§šç¿”å®‡ | 2021302474 | 10042101 |

</div>  

- [æ¨¡å¼è¯†åˆ«ä¸æœºå™¨å­¦ä¹ æŠ¥å‘Š](#æ¨¡å¼è¯†åˆ«ä¸æœºå™¨å­¦ä¹ æŠ¥å‘Š)
  - [ä»»åŠ¡1ï¼šå¤šé¡¹å¼å›å½’](#ä»»åŠ¡1å¤šé¡¹å¼å›å½’)
    - [1.ä»»åŠ¡æè¿°](#1ä»»åŠ¡æè¿°)
    - [2.æ•°æ®é›†æè¿°](#2æ•°æ®é›†æè¿°)
    - [3.ä»»åŠ¡åˆ†æ](#3ä»»åŠ¡åˆ†æ)
      - [æ™®é€šæœ€å°äºŒä¹˜æ³•](#æ™®é€šæœ€å°äºŒä¹˜æ³•)
    - [4.ä»£ç å®ç°ä¸åˆ†æ](#4ä»£ç å®ç°ä¸åˆ†æ)
      - [4.1 æ•°æ®é›†è¯»å–ä¸æ•°æ®é¢„å¤„ç†](#41-æ•°æ®é›†è¯»å–ä¸æ•°æ®é¢„å¤„ç†)
      - [4.2 æ¨¡å‹è®­ç»ƒ](#42-æ¨¡å‹è®­ç»ƒ)
      - [4.3 æ¨¡å‹è¯„ä»·ä¸é¢„æµ‹](#43-æ¨¡å‹è¯„ä»·ä¸é¢„æµ‹)
      - [4.4 ç»“æœå¯è§†åŒ–](#44-ç»“æœå¯è§†åŒ–)
    - [5.æµ‹è¯•ç»“æœå±•ç¤º](#5æµ‹è¯•ç»“æœå±•ç¤º)
      - [5.1 ä¸åŒé˜¶æ•°ä¸‹çš„MSE](#51-ä¸åŒé˜¶æ•°ä¸‹çš„mse)
      - [5.2 ä¸åŒé˜¶æ•°ä¸‹çš„å›¾åƒæ›²çº¿ä»¥åŠè¡¨è¾¾å¼](#52-ä¸åŒé˜¶æ•°ä¸‹çš„å›¾åƒæ›²çº¿ä»¥åŠè¡¨è¾¾å¼)
  - [ä»»åŠ¡2ï¼šæ¦‚ç‡åˆ†ç±»æ³•](#ä»»åŠ¡2æ¦‚ç‡åˆ†ç±»æ³•)
    - [1.ä»»åŠ¡æè¿°](#1ä»»åŠ¡æè¿°-1)
    - [2.æ•°æ®é›†æè¿°](#2æ•°æ®é›†æè¿°-1)
    - [3.ä»»åŠ¡åˆ†æ](#3ä»»åŠ¡åˆ†æ-1)
- [pass](#pass)
      - [æ•°å­¦åŸºç¡€](#æ•°å­¦åŸºç¡€)
        - [è´å¶æ–¯ä¼°è®¡](#è´å¶æ–¯ä¼°è®¡)
        - [æœ€å¤§ä¼¼ç„¶ä¼°è®¡](#æœ€å¤§ä¼¼ç„¶ä¼°è®¡)
    - [4.ä»£ç å®ç°ä¸åˆ†æ](#4ä»£ç å®ç°ä¸åˆ†æ-1)
    - [5.è¿è¡Œç»“æœå±•ç¤º](#5è¿è¡Œç»“æœå±•ç¤º)



---

## ä»»åŠ¡1ï¼šå¤šé¡¹å¼å›å½’

### 1.ä»»åŠ¡æè¿°
å¤šé¡¹å¼å›å½’æ˜¯ä¸€ç§å›å½’åˆ†æå½¢å¼ï¼Œåœ¨è¿™ç§å½¢å¼ä¸­ï¼Œè‡ªå˜é‡ ( x ) å’Œå› å˜é‡ ( y ) ä¹‹é—´çš„å…³ç³»è¢«å»ºæ¨¡ä¸º ( n ) é˜¶å¤šé¡¹å¼ã€‚ä½¿ç”¨æœºå™¨å­¦ä¹ çš„æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªå¤šé¡¹å¼å›å½’æ¨¡å‹ï¼Œè¯¥æ¨¡å‹å¯ä»¥æ ¹æ®ç»™å®šçš„æ•°æ®é›†é¢„æµ‹ç»“æœã€‚æ•°æ®é›†ç”±è‡ªå˜é‡ ( x ) å’Œå› å˜é‡ ( y ) ç»„æˆï¼Œä½ çš„ä»»åŠ¡æ˜¯æ‰¾åˆ°ä¸€ä¸ªå¤šé¡¹å¼ï¼Œèƒ½æœ€å¥½åœ°æè¿° ( x ) å’Œ ( y ) ä¹‹é—´çš„å…³ç³»ã€‚

### 2.æ•°æ®é›†æè¿°
æœ¬å®éªŒé€‰å–æ•°æ®é›†åŒ…å«125ä¸ªæ ·æœ¬ç‚¹ï¼Œæ¯ä¸ªæ ·æœ¬å…·æœ‰ä¸€ä¸ªè‡ªå˜é‡( x )å’Œä¸€ä¸ªå› å˜é‡( y )ã€‚æ•°æ®é›†æ ¹æ®4:1çš„æ¯”ä¾‹åˆ’åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ã€‚

### 3.ä»»åŠ¡åˆ†æ
å¤šé¡¹å¼å›å½’æ˜¯ä¸€ç§å›å½’åˆ†ææ–¹å¼ï¼Œé€šè¿‡å¤šé¡¹å¼å‡½æ•°æ¥æ‹Ÿåˆæ•°æ®é›†ï¼Œè¿™ç§æ–¹æ³•é€‚ç”¨äºæ•°æ®å’Œä¸€ä¸ªæˆ–å¤šä¸ªéçº¿æ€§å…³ç³»çš„æƒ…å†µã€‚å¤šé¡¹å¼å›å½’æ¨¡å‹çš„å½¢å¼å¦‚ä¸‹ï¼š
<div align=center>

$$
y = \beta_0+\beta_1x+\beta_2x^2+\beta_3x^3+...+\beta_nx^n+\epsilon 
$$

</div>

åœ¨å¤šé¡¹å¼å›å½’æ¨¡å‹ä¸­ï¼Œè‡ªå˜é‡çš„ä¸åŒæ¬¡æ–¹$x^2$,$x^3$,...$x^n$è¢«ä½œä¸ºæ–°ç‰¹å¾åŠ å…¥åˆ°æ¨¡å‹ä¸­ã€‚é€šè¿‡è®­ç»ƒæ•°æ®ï¼Œä½¿ç”¨æ™®é€šæœ€å°äºŒä¹˜æ³•ç­‰ç®—æ³•æ¥ä¼°è®¡å›å½’ç³»æ•°$\{ \beta_0,\beta_1,\beta_2...\beta_n\}$,ä»è€Œæ•æ‰æ•°æ®ä¸­çš„éçº¿æ€§å…³ç³»ã€‚

#### æ™®é€šæœ€å°äºŒä¹˜æ³•
æ™®é€šæœ€å°äºŒä¹˜æ³•æ˜¯ä¼°è®¡å¤šé¡¹å¼å›å½’æ¨¡å‹ç³»æ•°çš„å¸¸ç”¨æ–¹æ³•ï¼Œå…¶ç›®æ ‡æ˜¯æœ€å°åŒ–å®é™…å€¼ä¸é¢„æµ‹å€¼ä¹‹é—´çš„è¯¯å·®å¹³æ–¹å’Œï¼š
<div align=center>

$RSS = \sum_{i=1}^{m} (y_i - \hat{y}_i)^2$

mä¸ºæ ·æœ¬æ•°ï¼Œ$y_i$ ä¸ºå®é™…å€¼, $\hat{y}_i$ä¸ºé¢„æµ‹å€¼ã€‚é€šè¿‡æœ€å°åŒ–RSSï¼Œå°±å¯ä»¥æ‰¾åˆ°æœ€ä½³çš„å›å½’ç³»æ•°$\beta_0,\beta_1,\beta_2,...,\beta_n$ã€‚

</div>

### 4.ä»£ç å®ç°ä¸åˆ†æ
#### 4.1 æ•°æ®é›†è¯»å–ä¸æ•°æ®é¢„å¤„ç†

æ•°æ®é›†å­˜å‚¨åœ¨`homwework.csv`æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨`numpy`åº“çš„`loadtxt`æ–¹æ³•æ¥è¯»å–æ•°æ®ã€‚ä¹‹ååˆ©ç”¨`reshape`å¢åŠ ä¸€ä¸ªç»´åº¦ä»¥æ–¹ä¾¿æ¨¡å‹è®­ç»ƒã€‚

```python
import numpy as np
from sklearn.preprocessing import PolynomialFeatures
import pandas as pd

train_data = np.loadtxt(
    open("ä½œä¸šä¸€/poly_reg/train_dataset.csv", "rb"), delimiter=",", skiprows=1
)
test_data = np.loadtxt(
    open("ä½œä¸šä¸€/poly_reg/test_dataset.csv", "rb"), delimiter=",", skiprows=1
)
new_test_data = pd.read_csv('ä½œä¸šä¸€/new_test.csv',header=0)


x_train = train_data[:, 0].reshape(-1, 1)
y_train = train_data[:, 1].reshape(-1, 1)
x_test = test_data[:, 0].reshape(-1, 1)
y_test = test_data[:, 1].reshape(-1, 1)
new_x_test=np.array(new_test_data['x'].values).reshape(-1,1)
```
æ¥ç€è®¾ç½®å¤šé¡¹å¼é˜¶æ•°ï¼Œå¹¶é‡‡ç”¨`sklearn.preprocessing`ä¸­çš„`PolynomialFeatures`æ–¹æ³•å¯¹è‡ªå˜é‡è¿›è¡Œç‰¹å¾æ‹“å±•ã€‚
```python
degree = 4

# å¤šé¡¹å¼ç‰¹å¾
poly_features = PolynomialFeatures(degree=degree)
x_train_poly = poly_features.fit_transform(x_train)
x_test_poly = poly_features.transform(x_test)
new_x_test_poly=poly_features.transform(new_x_test)
```

#### 4.2 æ¨¡å‹è®­ç»ƒ
é‡‡ç”¨`sklearn.linear_model`ä¸­çš„`LinearRegression`ä½œä¸ºæ¨¡å‹ï¼Œé€šè¿‡æ¨¡å‹çš„`fit()`æ–¹æ³•è¿›è¡Œè®­ç»ƒ

```python
# æ¨¡å‹è®­ç»ƒ
from sklearn.linear_model import LinearRegression

model = LinearRegression()
model.fit(x_train_poly, y_train)

```
#### 4.3 æ¨¡å‹è¯„ä»·ä¸é¢„æµ‹
ä½¿ç”¨æµ‹è¯•é›†å¯¹æ¨¡å‹è¿›è¡Œè¯„ä»·ï¼Œå¹¶å¯¹ä½œä¸šæ•°æ®é›†è¿›è¡Œé¢„æµ‹ï¼Œé€šè¿‡`sklearn.metrics`ä¸­çš„`mean_squared_error`è®¡ç®—æµ‹è¯•é›†çš„MSEï¼Œå°†ä½œä¸šæ•°æ®é›†çš„é¢„æµ‹ç»“æœç›´æ¥å­˜å‚¨å›åŸæ–‡ä»¶
```python
from sklearn.metrics import mean_squared_error

#æµ‹è¯•
train_predictions = model.predict(x_train_poly)
test_predictions = model.predict(x_test_poly)

#æ–¹å·®
train_mse= mean_squared_error(y_train,train_predictions)
test_mse = mean_squared_error(y_test,test_predictions)

print("è®­ç»ƒé›†æ–¹å·®:",train_mse)
print("æµ‹è¯•é›†æ–¹å·®",test_mse)

#ä½œä¸šæäº¤éƒ¨åˆ†
new_test_prediction=model.predict(new_x_test_poly)
#print(new_test_prediction)
new_test_data['y']=new_test_prediction
new_test_data.to_csv("ä½œä¸šä¸€/homework.csv",index=False)
```

#### 4.4 ç»“æœå¯è§†åŒ–
ä¸ºäº†èƒ½å¤Ÿæ›´åŠ ç›´è§‚çš„è§‚å¯Ÿæ¨¡å‹è®­ç»ƒæ•ˆæœï¼Œé‡‡ç”¨`matplotlib.pyplot`è¿›è¡Œå›¾åƒç»˜åˆ¶ï¼Œå¹¶ä¸”é€šè¿‡æ ¼å¼åŒ–è¾“å‡ºæ¥è¾“å‡ºæœ€ç»ˆçš„å›å½’æ›²çº¿è¡¨è¾¾å¼ã€‚
```python
import matplotlib.pyplot as plt

# ç»˜å›¾
plt.scatter(x_train, y_train, color='blue', label='Train data')
plt.scatter(x_test, y_test, color='red', label='Test data')

# ä¸ºäº†ç»˜åˆ¶å¹³æ»‘æ›²çº¿ï¼Œç”Ÿæˆè®¸å¤šç‚¹æ¥é¢„æµ‹
x_range = np.linspace(x_train.min(), x_train.max(), 500).reshape(-1, 1)
x_range_poly = poly_features.transform(x_range)
y_range_pred = model.predict(x_range_poly)

# è¾“å‡ºå¤šé¡¹å¼è¡¨è¾¾å¼ï¼ˆä»…åŒ…å«éé›¶ç³»æ•°çš„é¡¹ï¼‰
coefficients = model.coef_[0]
intercept = model.intercept_[0]

# æ„å»ºå¤šé¡¹å¼è¡¨è¾¾å¼å­—ç¬¦ä¸²
poly_expression = f"f(x) = {intercept:.2f}"
for i in range(1, degree + 1):
    if coefficients[i] != 0:
        poly_expression += f" + {coefficients[i]:.2f}x^{i}"

print("å¤šé¡¹å¼å›å½’æ¨¡å‹è¡¨è¾¾å¼ï¼š", poly_expression)

#ç»˜å›¾
plt.plot(x_range, y_range_pred, color='green', label=f'Polynomial Degree {degree}')
plt.title(poly_expression)
plt.xlabel('X')
plt.ylabel('Y')
plt.legend()
plt.savefig("ä½œä¸šä¸€/png_homework.png")
plt.show()
```


### 5.æµ‹è¯•ç»“æœå±•ç¤º
#### 5.1 ä¸åŒé˜¶æ•°ä¸‹çš„MSE
degree=2
![alt text](image.png)
degree=4
![alt text](image-1.png)
degree=6
![alt text](image-2.png)
degree=8
![alt text](image-3.png)

#### 5.2 ä¸åŒé˜¶æ•°ä¸‹çš„å›¾åƒæ›²çº¿ä»¥åŠè¡¨è¾¾å¼
degree=2
![alt text](img_1.png)
degree=4
![alt text](img_2.png)
degree=6
![alt text](img_3.png)
degree=8
![alt text](img_4.png)

---

## ä»»åŠ¡2ï¼šæ¦‚ç‡åˆ†ç±»æ³•
### 1.ä»»åŠ¡æè¿°
ä½¿ç”¨è´å¶æ–¯ä¼°è®¡æˆ–MLEï¼ˆæœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼‰ï¼Œæ¥é¢„æµ‹é¸¢å°¾èŠ±æ•°æ®é›†ä¸­èŠ±çš„ç§ç±»ã€‚
### 2.æ•°æ®é›†æè¿°
é¸¢å°¾èŠ±æ•°æ®é›†æ˜¯ç»Ÿè®¡å­¦å’Œæœºå™¨å­¦ä¹ ä¸­ç”¨äºåˆ†ç±»çš„ç»å…¸æ•°æ®é›†ã€‚è¯¥æ•°æ®é›†åŒ…å«äº†ä¸‰ç§ä¸åŒçš„é¸¢å°¾èŠ±ï¼šSetosaã€Versicolorå’ŒVirginicaï¼Œæ¯ç§å„50ä¸ªæ ·æœ¬ã€‚æ¯ä¸ªæ ·æœ¬æœ‰å››ä¸ªå±æ€§ï¼šè¼ç‰‡é•¿åº¦ã€è¼ç‰‡å®½åº¦ã€èŠ±ç“£é•¿åº¦å’ŒèŠ±ç“£å®½åº¦ï¼Œæ‰€æœ‰çš„æµ‹é‡å•ä½éƒ½æ˜¯å˜ç±³ã€‚æ•°æ®é›†æ ¹æ®4:1çš„æ¯”ä¾‹åˆ’åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ã€‚æ¦‚ç‡åˆ†ç±»æ³•æ˜¯ä¸€ç§åŸºäºæ¦‚ç‡ç†è®ºçš„æ–¹æ³•ï¼Œé€‚åˆå¤„ç†æ­¤ç±»åˆ†ç±»é—®é¢˜ã€‚
### 3.ä»»åŠ¡åˆ†æ
è´å¶æ–¯ä¼°è®¡å’ŒMLEæ˜¯ç»Ÿè®¡å­¦ä¸­å¸¸ç”¨çš„ä¸¤ç§æ–¹æ³•ï¼Œç”¨äºå‚æ•°ä¼°è®¡ä¸åˆ†ç±»ä»»åŠ¡ã€‚å…¶ä¸­ï¼Œè´å¶æ–¯ä¼°è®¡åˆ©ç”¨å…ˆéªŒçŸ¥è¯†å’Œæ•°æ®æ¥è¿›è¡Œå‚æ•°ä¼°è®¡ï¼ŒMLEåˆ™æ˜¯é€šè¿‡æœ€å¤§åŒ–ä¼¼ç„¶å‚æ•°æ¥ä¼°è®¡å‚æ•°ã€‚è¿™ä¸¤ç§æ–¹æ³•éƒ½é€‚ç”¨äºåˆ†ç±»é—®é¢˜ï¼Œå¦‚æœ¬æ¬¡çš„é¸¢å°¾èŠ±æ•°æ®é›†åˆ†ç±»ã€‚
# pass
#### æ•°å­¦åŸºç¡€
##### è´å¶æ–¯ä¼°è®¡
è´å¶æ–¯ä¼°è®¡é€šè¿‡ç»“åˆå…ˆéªŒåˆ†å¸ƒå’Œä¼¼ç„¶å‡½æ•°æ¥ä¼°è®¡å‚æ•°ã€‚è´å¶æ–¯å…¬å¼å¦‚ä¸‹ï¼š
<div align = center>

$P(\theta|X)=\frac{P(X|\theta)P(\theta)}{P(X)}$

</div>  

å…¶ä¸­ï¼Œ$P(\theta|X)$ æ˜¯ç»™å®šæ•°æ® $X$ åå‚æ•° $\theta$ çš„åéªŒæ¦‚ç‡ï¼›$P(X|\theta)$ æ˜¯ç»™å®šå‚æ•° $\theta$ åæ•°æ® $X$ çš„ä¼¼ç„¶å‡½æ•°ï¼›$P(\theta)$ æ˜¯å‚æ•° $\theta$ çš„æ¦‚ç‡ï¼›$P(X)$ æ˜¯æ•°æ®Xçš„æ¦‚ç‡
##### æœ€å¤§ä¼¼ç„¶ä¼°è®¡
æœ€å¤§ä¼¼ç„¶ä¼°è®¡é€šè¿‡æœ€å¤§åŒ–ä¼¼ç„¶å‡½æ•°æ¥ä¼°è®¡å‚æ•°ã€‚ä¼¼ç„¶å‡½æ•°è¡¨ç¤ºç»™å®šå‚æ•° $\theta$ æ—¶æ•°æ®å‡ºç°çš„æ¦‚ç‡ã€‚æœ€å¤§ä¼¼ç„¶ä¼°è®¡å°±æ˜¯è¦æ‰¾åˆ°ä½¿å¾—ä¼¼ç„¶å‡½æ•°æœ€å¤§çš„å‚æ•° $\theta$. ä¼¼ç„¶å‡½æ•°å¦‚ä¸‹
<div align=center>

$ ğ¿(ğœƒ|ğ‘‹)=ğ‘ƒ(ğ‘‹|ğœƒ)$

</div>

### 4.ä»£ç å®ç°ä¸åˆ†æ
### 5.è¿è¡Œç»“æœå±•ç¤º